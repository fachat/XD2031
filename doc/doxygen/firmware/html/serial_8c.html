<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>XD2031 firmware: serial.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">XD2031 firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">serial.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="version_8h_source.html">version.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="packet_8h_source.html">packet.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="provider_8h_source.html">provider.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="wireformat_8h_source.html">wireformat.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="serial_8h_source.html">serial.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="uarthw_8h_source.html">uarthw.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="petscii_8h_source.html">petscii.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="debug_8h_source.html">debug.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="led_8h_source.html">led.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for serial.c:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c__incl.png" border="0" usemap="#serial_8c" alt=""/></div>
<map name="serial_8c" id="serial_8c">
<area shape="rect" id="node7" href="version_8h.html" title="version.h" alt="" coords="178,83,253,111"/><area shape="rect" id="node9" href="packet_8h.html" title="packet.h" alt="" coords="331,315,401,343"/><area shape="rect" id="node13" href="wireformat_8h.html" title="wireformat.h" alt="" coords="217,393,311,421"/><area shape="rect" id="node25" href="provider_8h.html" title="provider.h" alt="" coords="421,238,500,266"/><area shape="rect" id="node36" href="serial_8h.html" title="serial.h" alt="" coords="429,161,493,189"/><area shape="rect" id="node39" href="uarthw_8h.html" title="uarthw.h" alt="" coords="480,83,551,111"/><area shape="rect" id="node41" href="petscii_8h.html" title="petscii.h" alt="" coords="576,83,645,111"/><area shape="rect" id="node43" href="debug_8h.html" title="debug.h" alt="" coords="669,83,739,111"/><area shape="rect" id="node52" href="led_8h.html" title="led.h" alt="" coords="763,83,812,111"/><area shape="rect" id="node17" href="delay_8h.html" title="delay.h" alt="" coords="335,393,397,421"/><area shape="rect" id="node15" href="errors_8h.html" title="errors.h" alt="" coords="237,470,304,498"/><area shape="rect" id="node19" href="delayhw_8h.html" title="delayhw.h" alt="" coords="330,470,411,498"/><area shape="rect" id="node29" href="errormsg_8h.html" title="errormsg.h" alt="" coords="525,393,611,421"/><area shape="rect" id="node45" href="term_8h.html" title="term.h" alt="" coords="554,161,613,189"/><area shape="rect" id="node48" href="mem_8h.html" title="mem.h" alt="" coords="673,161,735,189"/></map>
</div>
</div>
<p><a href="serial_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acb4b7b3034709a082b08fadd8f2bcfea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:acb4b7b3034709a082b08fadd8f2bcfea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5fc526bad9896abab0a44a2a06322e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a0b5fc526bad9896abab0a44a2a06322e">TX_TYPE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a0b5fc526bad9896abab0a44a2a06322e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9732bbd7f00ac8d4ed8601a6b14a8b68"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a9732bbd7f00ac8d4ed8601a6b14a8b68">TX_LEN</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a9732bbd7f00ac8d4ed8601a6b14a8b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb4a7d6496e251ae4b9b151f27f7296"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a0fb4a7d6496e251ae4b9b151f27f7296">TX_CHANNEL</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a0fb4a7d6496e251ae4b9b151f27f7296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7aa78c51c5c51bbfd493bf42bef0de3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ab7aa78c51c5c51bbfd493bf42bef0de3">TX_DATA</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:ab7aa78c51c5c51bbfd493bf42bef0de3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8466586b863fc4b1722eda703698d847"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a8466586b863fc4b1722eda703698d847">TX_IDLE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:a8466586b863fc4b1722eda703698d847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8dbeb081056c2044a8622100b20f4c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ae8dbeb081056c2044a8622100b20f4c5">RX_IDLE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ae8dbeb081056c2044a8622100b20f4c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0224d1be60d9fdd214f3e4c20df878a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ac0224d1be60d9fdd214f3e4c20df878a">RX_LEN</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ac0224d1be60d9fdd214f3e4c20df878a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c0e8466f41101fefa31dffdf633c79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ad3c0e8466f41101fefa31dffdf633c79">RX_CHANNELNO</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ad3c0e8466f41101fefa31dffdf633c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b21c450cfc5c88ba50c5049177f0d2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a90b21c450cfc5c88ba50c5049177f0d2">RX_DATA</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a90b21c450cfc5c88ba50c5049177f0d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab88c7a2f9370ff3179a1247935d18912"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ab88c7a2f9370ff3179a1247935d18912">RX_IGNORE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ab88c7a2f9370ff3179a1247935d18912"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3bb6e8286980b507589e1a799e752f9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9">serial_submit</a> (void *epdata, <a class="el" href="structpacket__t.html">packet_t</a> *<a class="el" href="term_8c.html#af534d0180d4264410342a4c3b60aaf21">buf</a>)</td></tr>
<tr class="separator:ac3bb6e8286980b507589e1a799e752f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3386cdb2f4c51be5b17839689bb0040b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b">serial_submit_call</a> (void *epdata, int8_t <a class="el" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>, <a class="el" href="structpacket__t.html">packet_t</a> *<a class="el" href="uarthw_8c.html#a78a3cb61ec9cceb8e5c7e2595995898e">txbuf</a>, <a class="el" href="structpacket__t.html">packet_t</a> *<a class="el" href="uarthw_8c.html#a78966124af88c57460ff4984045de16b">rxbuf</a>, void(*<a class="el" href="serial_8c.html#ac7063263faf9c3950f983dea0effb3bf">callback</a>)(int8_t <a class="el" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>, int8_t errnum))</td></tr>
<tr class="separator:a3386cdb2f4c51be5b17839689bb0040b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a723b54d8d0110a7475aee8bc4f99771f"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a723b54d8d0110a7475aee8bc4f99771f">directory_converter</a> (<a class="el" href="structpacket__t.html">packet_t</a> *p)</td></tr>
<tr class="separator:a723b54d8d0110a7475aee8bc4f99771f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a712a34abec8b577c05727ef97eaab99d"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a712a34abec8b577c05727ef97eaab99d">to_provider</a> (<a class="el" href="structpacket__t.html">packet_t</a> *p)</td></tr>
<tr class="separator:a712a34abec8b577c05727ef97eaab99d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989dca2fed922a7ea61c23ed6ecba0e3"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a989dca2fed922a7ea61c23ed6ecba0e3">prov_assign</a> (const char *<a class="el" href="provider_8c.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>)</td></tr>
<tr class="separator:a989dca2fed922a7ea61c23ed6ecba0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380438ade608ee2aaeb7fd989400b34a"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a380438ade608ee2aaeb7fd989400b34a">prov_free</a> (void *epdata)</td></tr>
<tr class="separator:a380438ade608ee2aaeb7fd989400b34a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1911a56ed285d7127e4d7137a271665d"><td class="memItemLeft" align="right" valign="top">static uint8_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a1911a56ed285d7127e4d7137a271665d">append</a> (uint8_t *outp, const char *to_append)</td></tr>
<tr class="separator:a1911a56ed285d7127e4d7137a271665d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6018e05fbcd807dce52864af635d12"><td class="memItemLeft" align="right" valign="top">static int16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12">read_char_from_packet</a> (<a class="el" href="structpacket__t.html">packet_t</a> *<a class="el" href="term_8c.html#af534d0180d4264410342a4c3b60aaf21">buf</a>)</td></tr>
<tr class="separator:ada6018e05fbcd807dce52864af635d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9126462beb6d6cfba1d6b5941557207"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207">advance_slots</a> ()</td></tr>
<tr class="separator:ab9126462beb6d6cfba1d6b5941557207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aaf52ad0a4ad585de528c2f40af36e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3">send</a> (void)</td></tr>
<tr class="separator:a6aaf52ad0a4ad585de528c2f40af36e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3258ff091e5e10fc76b30cd24e55596"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ab3258ff091e5e10fc76b30cd24e55596">push_data_to_packet</a> (int8_t rxdata)</td></tr>
<tr class="separator:ab3258ff091e5e10fc76b30cd24e55596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a467023822de9459179b4c9a13da0d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a2a467023822de9459179b4c9a13da0d1">serial_delay</a> ()</td></tr>
<tr class="separator:a2a467023822de9459179b4c9a13da0d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94547a891c369354cec16547930de449"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a94547a891c369354cec16547930de449">serial_flush</a> ()</td></tr>
<tr class="separator:a94547a891c369354cec16547930de449"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7081e02f83b04f6ef96aeb13ba52262d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structprovider__t.html">provider_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a7081e02f83b04f6ef96aeb13ba52262d">serial_init</a> ()</td></tr>
<tr class="separator:a7081e02f83b04f6ef96aeb13ba52262d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ddf2fb0d23eab0aa1ccefa91149255"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ab9ddf2fb0d23eab0aa1ccefa91149255">serial_sync</a> ()</td></tr>
<tr class="separator:ab9ddf2fb0d23eab0aa1ccefa91149255"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af07f8902149a4e7ca73a4586578457c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structprovider__t.html">provider_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#af07f8902149a4e7ca73a4586578457c5">serial_provider</a></td></tr>
<tr class="separator:af07f8902149a4e7ca73a4586578457c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d19af77ffdf5eb8e5a80a706ed475c"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a15d19af77ffdf5eb8e5a80a706ed475c">slots</a> [<a class="el" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>]</td></tr>
<tr class="separator:a15d19af77ffdf5eb8e5a80a706ed475c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa059c7f18fb4caf7aa2e187d71baf311"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> = 0</td></tr>
<tr class="separator:aa059c7f18fb4caf7aa2e187d71baf311"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a417e32f683a22f22699d87c214ef9bfb"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a></td></tr>
<tr class="separator:a417e32f683a22f22699d87c214ef9bfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60aa9126f8c6113641042eeccf231bd8"><td class="memItemLeft" >struct {</td></tr>
<tr class="memitem:aa44526c5384fd0ebbae40062387b2683"><td class="memItemLeft" >&#160;&#160;&#160;int8_t&#160;&#160;&#160;<a class="el" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a></td></tr>
<tr class="separator:aa44526c5384fd0ebbae40062387b2683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab69421981f084b93cfd591a7d8403348"><td class="memItemLeft" >&#160;&#160;&#160;<a class="el" href="structpacket__t.html">packet_t</a> *&#160;&#160;&#160;<a class="el" href="serial_8c.html#ab69421981f084b93cfd591a7d8403348">rxpacket</a></td></tr>
<tr class="separator:ab69421981f084b93cfd591a7d8403348"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7063263faf9c3950f983dea0effb3bf"><td class="memItemLeft" >&#160;&#160;&#160;void(*&#160;&#160;&#160;<a class="el" href="serial_8c.html#ac7063263faf9c3950f983dea0effb3bf">callback</a> )(int8_t <a class="el" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>, int8_t errnum)</td></tr>
<tr class="separator:ac7063263faf9c3950f983dea0effb3bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60aa9126f8c6113641042eeccf231bd8"><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a> [<a class="el" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>]</td></tr>
<tr class="separator:a60aa9126f8c6113641042eeccf231bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a121d79bdb3f9705ff8e0a6c368094a5b"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a></td></tr>
<tr class="separator:a121d79bdb3f9705ff8e0a6c368094a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a73c94ff2e1a886f0139d4a1a487150"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a4a73c94ff2e1a886f0139d4a1a487150">current_channelno</a></td></tr>
<tr class="separator:a4a73c94ff2e1a886f0139d4a1a487150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4badad1d3d72e7a8c6104d604725906e"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a></td></tr>
<tr class="separator:a4badad1d3d72e7a8c6104d604725906e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a682bd146c8dfd08d349238cb44a0a4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a3a682bd146c8dfd08d349238cb44a0a4">current_rxpacket</a></td></tr>
<tr class="separator:a3a682bd146c8dfd08d349238cb44a0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a814f24a889da2738662302f05cef093c"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#a814f24a889da2738662302f05cef093c">current_data_left</a></td></tr>
<tr class="separator:a814f24a889da2738662302f05cef093c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f6b6d398bc21dfe9dc608da0ee0995"><td class="memItemLeft" align="right" valign="top">static int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#ab8f6b6d398bc21dfe9dc608da0ee0995">current_is_eoi</a></td></tr>
<tr class="separator:ab8f6b6d398bc21dfe9dc608da0ee0995"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16b9b5a49ddd8393fa812b5523a2bad"><td class="memItemLeft" align="right" valign="top">static uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="serial_8c.html#af16b9b5a49ddd8393fa812b5523a2bad">out</a> [64]</td></tr>
<tr class="separator:af16b9b5a49ddd8393fa812b5523a2bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="acb4b7b3034709a082b08fadd8f2bcfea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUMBER_OF_SLOTS&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00099">99</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>, <a class="el" href="serial_8c_source.html#l00555">serial_init()</a>, <a class="el" href="serial_8c_source.html#l00484">serial_submit()</a>, and <a class="el" href="serial_8c_source.html#l00521">serial_submit_call()</a>.</p>

</div>
</div>
<a class="anchor" id="ad3c0e8466f41101fefa31dffdf633c79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RX_CHANNELNO&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00124">124</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a90b21c450cfc5c88ba50c5049177f0d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RX_DATA&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00125">125</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="ae8dbeb081056c2044a8622100b20f4c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RX_IDLE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00122">122</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>, and <a class="el" href="serial_8c_source.html#l00555">serial_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ab88c7a2f9370ff3179a1247935d18912"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RX_IGNORE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00126">126</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0224d1be60d9fdd214f3e4c20df878a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RX_LEN&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00123">123</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a0fb4a7d6496e251ae4b9b151f27f7296"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_CHANNEL&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00110">110</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00312">read_char_from_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7aa78c51c5c51bbfd493bf42bef0de3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_DATA&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00111">111</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00312">read_char_from_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a8466586b863fc4b1722eda703698d847"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_IDLE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00112">112</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00312">read_char_from_packet()</a>, and <a class="el" href="serial_8c_source.html#l00555">serial_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a9732bbd7f00ac8d4ed8601a6b14a8b68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_LEN&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00109">109</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00312">read_char_from_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b5fc526bad9896abab0a44a2a06322e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_TYPE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00108">108</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00346">advance_slots()</a>, <a class="el" href="serial_8c_source.html#l00312">read_char_from_packet()</a>, and <a class="el" href="serial_8c_source.html#l00484">serial_submit()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ab9126462beb6d6cfba1d6b5941557207"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void advance_slots </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00346">346</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00108">TX_TYPE</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00356">send()</a>.</p>
<div class="fragment"><div class="line">                            {</div>
<div class="line">    uint8_t i = 0;</div>
<div class="line">    <a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a>--;</div>
<div class="line">    <span class="keywordflow">while</span> (i &lt; <a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a>) {</div>
<div class="line">        <a class="code" href="serial_8c.html#a15d19af77ffdf5eb8e5a80a706ed475c">slots</a>[i] = <a class="code" href="serial_8c.html#a15d19af77ffdf5eb8e5a80a706ed475c">slots</a>[i+1];</div>
<div class="line">        i++;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a0b5fc526bad9896abab0a44a2a06322e">TX_TYPE</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ab9126462beb6d6cfba1d6b5941557207_icgraph.png" border="0" usemap="#serial_8c_ab9126462beb6d6cfba1d6b5941557207_icgraph" alt=""/></div>
<map name="serial_8c_ab9126462beb6d6cfba1d6b5941557207_icgraph" id="serial_8c_ab9126462beb6d6cfba1d6b5941557207_icgraph">
<area shape="rect" id="node3" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3" title="send" alt="" coords="160,57,210,85"/><area shape="rect" id="node5" href="serial_8c.html#ab3258ff091e5e10fc76b30cd24e55596" title="push_data_to_packet" alt="" coords="259,5,408,33"/><area shape="rect" id="node7" href="serial_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="474,31,566,59"/><area shape="rect" id="node10" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9" title="serial_submit" alt="" coords="283,109,383,137"/><area shape="rect" id="node12" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b" title="serial_submit_call" alt="" coords="456,109,584,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1911a56ed285d7127e4d7137a271665d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint8_t* append </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>outp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to_append</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00143">143</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="petscii_8h_source.html#l00046">ascii_to_petscii()</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00166">directory_converter()</a>.</p>
<div class="fragment"><div class="line">                                                             {</div>
<div class="line">    <span class="keywordflow">while</span>(*to_append != 0) {</div>
<div class="line">        *outp = <a class="code" href="petscii_8h.html#a66b243cac1417df5362d9b729a8fa30e">ascii_to_petscii</a>(*to_append);</div>
<div class="line">        outp++;</div>
<div class="line">        to_append++;</div>
<div class="line">    }</div>
<div class="line">    *outp = 0;</div>
<div class="line">    outp++;</div>
<div class="line">    <span class="keywordflow">return</span> outp;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a1911a56ed285d7127e4d7137a271665d_cgraph.png" border="0" usemap="#serial_8c_a1911a56ed285d7127e4d7137a271665d_cgraph" alt=""/></div>
<map name="serial_8c_a1911a56ed285d7127e4d7137a271665d_cgraph" id="serial_8c_a1911a56ed285d7127e4d7137a271665d_cgraph">
<area shape="rect" id="node3" href="petscii_8h.html#a66b243cac1417df5362d9b729a8fa30e" title="ascii_to_petscii" alt="" coords="120,5,232,33"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a1911a56ed285d7127e4d7137a271665d_icgraph.png" border="0" usemap="#serial_8c_a1911a56ed285d7127e4d7137a271665d_icgraph" alt=""/></div>
<map name="serial_8c_a1911a56ed285d7127e4d7137a271665d_icgraph" id="serial_8c_a1911a56ed285d7127e4d7137a271665d_icgraph">
<area shape="rect" id="node3" href="serial_8c.html#a723b54d8d0110a7475aee8bc4f99771f" title="directory_converter" alt="" coords="120,5,256,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a723b54d8d0110a7475aee8bc4f99771f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int8_t directory_converter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00166">166</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00143">append()</a>, <a class="el" href="petscii_8h_source.html#l00046">ascii_to_petscii()</a>, <a class="el" href="debug_8h_source.html#l00038">debug_putc()</a>, <a class="el" href="debug_8h_source.html#l00039">debug_putcrlf()</a>, <a class="el" href="debug_8h_source.html#l00055">debug_puthex()</a>, <a class="el" href="debug_8h_source.html#l00042">debug_puts</a>, <a class="el" href="wireformat_8h_source.html#l00079">FS_DIR_LEN</a>, <a class="el" href="wireformat_8h_source.html#l00094">FS_DIR_MOD_DIR</a>, <a class="el" href="wireformat_8h_source.html#l00091">FS_DIR_MOD_FIL</a>, <a class="el" href="wireformat_8h_source.html#l00093">FS_DIR_MOD_FRE</a>, <a class="el" href="wireformat_8h_source.html#l00092">FS_DIR_MOD_NAM</a>, <a class="el" href="wireformat_8h_source.html#l00086">FS_DIR_MODE</a>, <a class="el" href="wireformat_8h_source.html#l00087">FS_DIR_NAME</a>, <a class="el" href="serial_8c_source.html#l00164">out</a>, <a class="el" href="packet_8h_source.html#l00095">packet_get_buffer()</a>, <a class="el" href="packet_8h_source.html#l00091">packet_get_capacity()</a>, <a class="el" href="packet_8h_source.html#l00153">packet_update_wp()</a>, and <a class="el" href="version_8h_source.html#l00029">SW_NAME_LOWER</a>.</p>
<div class="fragment"><div class="line">                                               {</div>
<div class="line">    uint8_t *inp = NULL;</div>
<div class="line">    uint8_t *outp = &amp;(<a class="code" href="serial_8c.html#af16b9b5a49ddd8393fa812b5523a2bad">out</a>[0]);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (p == NULL) {</div>
<div class="line">        <a class="code" href="debug_8h.html#af1318f845116bd417e969fa7c340ff36">debug_puts</a>(<span class="stringliteral">&quot;P IS NULL!&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    inp = <a class="code" href="packet_8h.html#adaf82ce76bb2027c911dc455f024e615">packet_get_buffer</a>(p);</div>
<div class="line">    uint8_t type = inp[<a class="code" href="wireformat_8h.html#a602d876bb8d21ac23806fec992e3364c">FS_DIR_MODE</a>];</div>
<div class="line"></div>
<div class="line">    <span class="comment">//packet_update_wp(p, 2);</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="wireformat_8h.html#a0d6dc2641ccc888a7aa3b8b8a2877841">FS_DIR_MOD_NAM</a>) {</div>
<div class="line">        *outp = 1; outp++;  <span class="comment">// load address low</span></div>
<div class="line">        *outp = 4; outp++;  <span class="comment">// load address high</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    *outp = 1; outp++;      <span class="comment">// link address low; will be overwritten on LOAD</span></div>
<div class="line">    *outp = 1; outp++;      <span class="comment">// link address high</span></div>
<div class="line"></div>
<div class="line">    uint16_t lineno = 0;</div>
<div class="line">    <span class="comment">// line number, derived from file length</span></div>
<div class="line">    <span class="keywordflow">if</span> (inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>+3] != 0 </div>
<div class="line">        || inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>+2] &gt; 0xf9</div>
<div class="line">        || (inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>+2] == 0xf9 &amp;&amp; inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>+1] == 0xff &amp;&amp; inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>] != 0)) {</div>
<div class="line">        <span class="comment">// more than limit of 63999 blocks</span></div>
<div class="line">        lineno = 63999;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        lineno = inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>+1] | (inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>+2] &lt;&lt; 8);</div>
<div class="line">        <span class="keywordflow">if</span> (inp[<a class="code" href="wireformat_8h.html#aa748e7e2b430cda9da605d727fe804c3">FS_DIR_LEN</a>] != 0) {</div>
<div class="line">            lineno++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    *outp = lineno &amp; 255; outp++;</div>
<div class="line">    *outp = (lineno&gt;&gt;8) &amp; 255; outp++;</div>
<div class="line"></div>
<div class="line">    <span class="comment">//snprintf(outp, 5, &quot;%hd&quot;, (unsigned short)lineno);</span></div>
<div class="line">    <span class="comment">//outp++;</span></div>
<div class="line">    <span class="keywordflow">if</span> (lineno &lt; 10) { *outp = <span class="charliteral">&#39; &#39;</span>; outp++; }</div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="wireformat_8h.html#a0d6dc2641ccc888a7aa3b8b8a2877841">FS_DIR_MOD_NAM</a>) {</div>
<div class="line">        *outp = 0x12;   <span class="comment">// reverse for disk name</span></div>
<div class="line">        outp++;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (type != <a class="code" href="wireformat_8h.html#ae4662b081c94b7b421c436f15f33fad0">FS_DIR_MOD_FRE</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> (lineno &lt; 100) { *outp = <span class="charliteral">&#39; &#39;</span>; outp++; }</div>
<div class="line">            <span class="keywordflow">if</span> (lineno &lt; 1000) { *outp = <span class="charliteral">&#39; &#39;</span>; outp++; }</div>
<div class="line">            <span class="keywordflow">if</span> (lineno &lt; 10000) { *outp = <span class="charliteral">&#39; &#39;</span>; outp++; }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (type != <a class="code" href="wireformat_8h.html#ae4662b081c94b7b421c436f15f33fad0">FS_DIR_MOD_FRE</a>) {</div>
<div class="line">        *outp = <span class="charliteral">&#39;&quot;&#39;</span>; outp++;</div>
<div class="line">        uint8_t i = <a class="code" href="wireformat_8h.html#af594f026264ffac3b48c9cc60c62bb70">FS_DIR_NAME</a>;</div>
<div class="line">        <span class="comment">// note the check i&lt;16 - this is buffer overflow protection</span></div>
<div class="line">        <span class="comment">// file names longer than 16 chars are not displayed</span></div>
<div class="line">        <span class="keywordflow">while</span> ((inp[i] != 0) &amp;&amp; (i &lt; (<a class="code" href="wireformat_8h.html#af594f026264ffac3b48c9cc60c62bb70">FS_DIR_NAME</a> + 16))) {</div>
<div class="line">            *outp = <a class="code" href="petscii_8h.html#a66b243cac1417df5362d9b729a8fa30e">ascii_to_petscii</a>(inp[i]);</div>
<div class="line">            outp++;</div>
<div class="line">            i++;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// note: not counted in i</span></div>
<div class="line">        *outp = <span class="charliteral">&#39;&quot;&#39;</span>; outp++;</div>
<div class="line">    </div>
<div class="line">        <span class="comment">// fill up with spaces, at least one space behind filename</span></div>
<div class="line">        <span class="keywordflow">while</span> (i &lt; <a class="code" href="wireformat_8h.html#af594f026264ffac3b48c9cc60c62bb70">FS_DIR_NAME</a> + 16 + 1) {</div>
<div class="line">            *outp = <span class="charliteral">&#39; &#39;</span>; outp++;</div>
<div class="line">            i++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// add file type</span></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="wireformat_8h.html#a0d6dc2641ccc888a7aa3b8b8a2877841">FS_DIR_MOD_NAM</a>) {</div>
<div class="line">        <span class="comment">// file name entry</span></div>
<div class="line">        outp = <a class="code" href="serial_8c.html#a1911a56ed285d7127e4d7137a271665d">append</a>(outp, <a class="code" href="version_8h.html#ad1aa23cdeb95856a01b6e274de8dff90">SW_NAME_LOWER</a>);</div>
<div class="line">        <span class="comment">//strcpy(outp, SW_NAME_LOWER);</span></div>
<div class="line">        <span class="comment">//outp += strlen(SW_NAME_LOWER)+1;  // includes ending 0-byte</span></div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="wireformat_8h.html#a254ee0365c0b27ae03d090d36e095040">FS_DIR_MOD_DIR</a>) {</div>
<div class="line">        outp = <a class="code" href="serial_8c.html#a1911a56ed285d7127e4d7137a271665d">append</a>(outp, <span class="stringliteral">&quot;dir&quot;</span>);</div>
<div class="line">        <span class="comment">//strcpy(outp, &quot;dir&quot;);</span></div>
<div class="line">        <span class="comment">//outp += 4;    // includes ending 0-byte</span></div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="wireformat_8h.html#aaffb46db0287f13c8fe481f2694e48e6">FS_DIR_MOD_FIL</a>) {</div>
<div class="line">        outp = <a class="code" href="serial_8c.html#a1911a56ed285d7127e4d7137a271665d">append</a>(outp, <span class="stringliteral">&quot;prg&quot;</span>);</div>
<div class="line">        <span class="comment">//strcpy(outp, &quot;prg&quot;);</span></div>
<div class="line">        <span class="comment">//outp += 4;    // includes ending 0-byte</span></div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code" href="wireformat_8h.html#ae4662b081c94b7b421c436f15f33fad0">FS_DIR_MOD_FRE</a>) {</div>
<div class="line">        outp = <a class="code" href="serial_8c.html#a1911a56ed285d7127e4d7137a271665d">append</a>(outp, <span class="stringliteral">&quot;blocks free&quot;</span>);</div>
<div class="line">        <span class="comment">//strcpy(outp, &quot;bytes free&quot;);</span></div>
<div class="line">        <span class="comment">//outp += 11;   // includes ending 0-byte</span></div>
<div class="line"></div>
<div class="line">        *outp = 0; outp++;  <span class="comment">// BASIC end marker (zero link address)</span></div>
<div class="line">        *outp = 0; outp++;  <span class="comment">// BASIC end marker (zero link address)</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    uint8_t len = outp - <a class="code" href="serial_8c.html#af16b9b5a49ddd8393fa812b5523a2bad">out</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (len &gt; <a class="code" href="packet_8h.html#a4b84dc4ee8eebb6cca40d98e6a031794">packet_get_capacity</a>(p)) {</div>
<div class="line">        <a class="code" href="debug_8h.html#af1318f845116bd417e969fa7c340ff36">debug_puts</a>(<span class="stringliteral">&quot;CONVERSION NOT POSSIBLE!&quot;</span>); <a class="code" href="debug_8h.html#a5a19c73a805a191cb89658d3a3fc308f">debug_puthex</a>(len); <a class="code" href="debug_8h.html#af964f239c289f93b082b6bb75f884fa2">debug_putcrlf</a>();</div>
<div class="line">        <span class="keywordflow">return</span> -1;  <span class="comment">// conversion not possible</span></div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if DEBUG_SERIAL</span></div>
<div class="line"><span class="preprocessor"></span>    <a class="code" href="debug_8h.html#af1318f845116bd417e969fa7c340ff36">debug_puts</a>(<span class="stringliteral">&quot;CONVERTED TO: LEN=&quot;</span>); <a class="code" href="debug_8h.html#a5a19c73a805a191cb89658d3a3fc308f">debug_puthex</a>(len);</div>
<div class="line">    <span class="keywordflow">for</span> (uint8_t j = 0; j &lt; len; j++) {</div>
<div class="line">        <a class="code" href="debug_8h.html#a5b082d074ba501fcb65a5b280331405d">debug_putc</a>(<span class="charliteral">&#39; &#39;</span>); <a class="code" href="debug_8h.html#a5a19c73a805a191cb89658d3a3fc308f">debug_puthex</a>(out[j]);</div>
<div class="line">    } </div>
<div class="line">    <a class="code" href="debug_8h.html#af964f239c289f93b082b6bb75f884fa2">debug_putcrlf</a>();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor"></span>    <span class="comment">// this should probably be combined</span></div>
<div class="line">    memcpy(<a class="code" href="packet_8h.html#adaf82ce76bb2027c911dc455f024e615">packet_get_buffer</a>(p), &amp;out, len);</div>
<div class="line">    <a class="code" href="packet_8h.html#a6a8c23bf46fabfa7a601d0cdcca4317f">packet_update_wp</a>(p, len);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a723b54d8d0110a7475aee8bc4f99771f_cgraph.png" border="0" usemap="#serial_8c_a723b54d8d0110a7475aee8bc4f99771f_cgraph" alt=""/></div>
<map name="serial_8c_a723b54d8d0110a7475aee8bc4f99771f_cgraph" id="serial_8c_a723b54d8d0110a7475aee8bc4f99771f_cgraph">
<area shape="rect" id="node3" href="serial_8c.html#a1911a56ed285d7127e4d7137a271665d" title="append" alt="" coords="228,39,294,67"/><area shape="rect" id="node5" href="petscii_8h.html#a66b243cac1417df5362d9b729a8fa30e" title="ascii_to_petscii" alt="" coords="381,13,493,41"/><area shape="rect" id="node8" href="debug_8h.html#a5b082d074ba501fcb65a5b280331405d" title="debug_putc" alt="" coords="542,194,634,222"/><area shape="rect" id="node26" href="debug_8h.html#af964f239c289f93b082b6bb75f884fa2" title="debug_putcrlf" alt="" coords="386,90,488,118"/><area shape="rect" id="node38" href="debug_8h.html#a5a19c73a805a191cb89658d3a3fc308f" title="debug_puthex" alt="" coords="208,194,314,222"/><area shape="rect" id="node43" href="packet_8h.html#adaf82ce76bb2027c911dc455f024e615" title="packet_get_buffer" alt="" coords="197,246,325,274"/><area shape="rect" id="node45" href="packet_8h.html#a4b84dc4ee8eebb6cca40d98e6a031794" title="packet_get_capacity" alt="" coords="190,298,333,326"/><area shape="rect" id="node47" href="packet_8h.html#a6a8c23bf46fabfa7a601d0cdcca4317f" title="packet_update_wp" alt="" coords="195,350,328,378"/><area shape="rect" id="node10" href="term_8c.html#ab38e92632b4de8af92283e500910a510" title="term_putc" alt="" coords="685,194,766,222"/><area shape="rect" id="node12" href="packet_8h.html#a2cade8ffc72b19e08f8fbff1ce795417" title="packet_wait_done" alt="" coords="817,194,946,222"/><area shape="rect" id="node20" href="term_8c.html#ad6b6b9297aa30da49f6dc3422bf708a4" title="send" alt="" coords="856,142,906,170"/><area shape="rect" id="node14" href="delay_8h.html#a304927311300df9e48c410ac5732d173" title="delayms" alt="" coords="1019,246,1090,274"/><area shape="rect" id="node18" href="packet_8h.html#ae18177b6d0283a274422f843fb924d81" title="packet_is_done" alt="" coords="997,194,1112,222"/><area shape="rect" id="node16" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="1176,219,1269,247"/><area shape="rect" id="node22" href="packet_8h.html#a437f19cbea67d2fcceab3daca7999b53" title="packet_set_filled" alt="" coords="994,142,1115,170"/><area shape="rect" id="node24" href="packet_8h.html#ac734d1711836633dfd94a48850b3a7a8" title="packet_set_read" alt="" coords="1163,142,1283,170"/><area shape="rect" id="node28" href="term_8c.html#ae337008fc505247280226b35d89757d0" title="term_flush" alt="" coords="684,90,767,118"/><area shape="rect" id="node34" href="term_8c.html#ab6dcca8982478b8e68429b51f690b568" title="term_putcrlf" alt="" coords="542,142,634,170"/><area shape="rect" id="node31" href="serial_8c.html#a94547a891c369354cec16547930de449" title="serial_flush" alt="" coords="837,90,926,118"/><area shape="rect" id="node40" href="debug_8h.html#a5dd69e91857c89f722568ab6eb8b95da" title="debug_putnib" alt="" coords="386,194,488,222"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a989dca2fed922a7ea61c23ed6ecba0e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* prov_assign </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00081">81</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>
<div class="fragment"><div class="line">                                           {</div>
<div class="line">    <span class="keywordflow">return</span> NULL;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a380438ade608ee2aaeb7fd989400b34a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void prov_free </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>epdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00086">86</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>
<div class="fragment"><div class="line">                                    {</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab3258ff091e5e10fc76b30cd24e55596"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void push_data_to_packet </td>
          <td>(</td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>rxdata</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>interrupt for received data </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00377">377</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00130">current_channelpos</a>, <a class="el" href="wireformat_8h_source.html#l00073">FS_EOF</a>, <a class="el" href="wireformat_8h_source.html#l00072">FS_REPLY</a>, <a class="el" href="wireformat_8h_source.html#l00046">FS_SYNC</a>, <a class="el" href="wireformat_8h_source.html#l00071">FS_WRITE</a>, <a class="el" href="serial_8c_source.html#l00099">NUMBER_OF_SLOTS</a>, <a class="el" href="packet_8h_source.html#l00132">packet_set_write()</a>, <a class="el" href="packet_8h_source.html#l00161">packet_write_char()</a>, <a class="el" href="serial_8c_source.html#l00124">RX_CHANNELNO</a>, <a class="el" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>, <a class="el" href="serial_8c_source.html#l00125">RX_DATA</a>, <a class="el" href="serial_8c_source.html#l00122">RX_IDLE</a>, <a class="el" href="serial_8c_source.html#l00126">RX_IGNORE</a>, <a class="el" href="serial_8c_source.html#l00123">RX_LEN</a>, <a class="el" href="serial_8c_source.html#l00356">send()</a>, <a class="el" href="uarthw_8c_source.html#l00075">uarthw_can_send()</a>, and <a class="el" href="uarthw_8c_source.html#l00084">uarthw_send()</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00453">serial_delay()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span>(<a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a>) {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#ae8dbeb081056c2044a8622100b20f4c5">RX_IDLE</a>:</div>
<div class="line">        <span class="comment">// no current packet</span></div>
<div class="line">        <span class="keywordflow">if</span> (rxdata == <a class="code" href="wireformat_8h.html#a0e1740f8851fca2f213c033d385f4667">FS_SYNC</a>) {</div>
<div class="line">            <span class="comment">// sync received</span></div>
<div class="line">            <span class="comment">// mirror the sync back</span></div>
<div class="line">            <span class="comment">// first flush all packets</span></div>
<div class="line">            <span class="keywordflow">while</span> (<a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> &gt; 0) {</div>
<div class="line">                <a class="code" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3">send</a>();</div>
<div class="line">            }</div>
<div class="line">            <span class="comment">// can we send?</span></div>
<div class="line">            <span class="keywordflow">while</span> (!<a class="code" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d">uarthw_can_send</a>());</div>
<div class="line">            <span class="comment">// yes, send sync</span></div>
<div class="line">            <a class="code" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c">uarthw_send</a>(<a class="code" href="wireformat_8h.html#a0e1740f8851fca2f213c033d385f4667">FS_SYNC</a>);</div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span> (rxdata == <a class="code" href="wireformat_8h.html#a54c7045bda7b963d296a3c5954954871">FS_REPLY</a> || rxdata == <a class="code" href="wireformat_8h.html#aef04baaf5affe32e8a65fc3f1c976b3b">FS_WRITE</a> || rxdata == <a class="code" href="wireformat_8h.html#a02e7b232f5280b690d2c1ab5ae4871f9">FS_EOF</a>) {</div>
<div class="line">            <span class="comment">// note EOI flag</span></div>
<div class="line">            <a class="code" href="serial_8c.html#ab8f6b6d398bc21dfe9dc608da0ee0995">current_is_eoi</a> = rxdata;</div>
<div class="line">            <span class="comment">// start a reply handling</span></div>
<div class="line">            <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#ac0224d1be60d9fdd214f3e4c20df878a">RX_LEN</a>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">//led_toggle();</span></div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#ac0224d1be60d9fdd214f3e4c20df878a">RX_LEN</a>:</div>
<div class="line">        <a class="code" href="serial_8c.html#a814f24a889da2738662302f05cef093c">current_data_left</a> = rxdata - 3;</div>
<div class="line">        <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#ad3c0e8466f41101fefa31dffdf633c79">RX_CHANNELNO</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#ad3c0e8466f41101fefa31dffdf633c79">RX_CHANNELNO</a>:</div>
<div class="line">        <a class="code" href="serial_8c.html#a4a73c94ff2e1a886f0139d4a1a487150">current_channelno</a> = rxdata;</div>
<div class="line">        <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#ab88c7a2f9370ff3179a1247935d18912">RX_IGNORE</a>;    <span class="comment">// fallback</span></div>
<div class="line">        <span class="comment">// find the current receive buffer</span></div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>; i++) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[i].<a class="code" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a> == <a class="code" href="serial_8c.html#a4a73c94ff2e1a886f0139d4a1a487150">current_channelno</a>) {</div>
<div class="line"><span class="comment">//if (current_is_eoi == FS_EOF &amp;&amp; current_data_left == 0) led_toggle();</span></div>
<div class="line">                <a class="code" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a> = i;</div>
<div class="line">                <a class="code" href="serial_8c.html#a3a682bd146c8dfd08d349238cb44a0a4">current_rxpacket</a> = <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[<a class="code" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a>].rxpacket;</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="packet_8h.html#af0ae4da4d34d8dab4f17f5d9a8e57436">packet_set_write</a>(<a class="code" href="serial_8c.html#a3a682bd146c8dfd08d349238cb44a0a4">current_rxpacket</a>, <a class="code" href="serial_8c.html#a4a73c94ff2e1a886f0139d4a1a487150">current_channelno</a>,</div>
<div class="line">                        <a class="code" href="serial_8c.html#ab8f6b6d398bc21dfe9dc608da0ee0995">current_is_eoi</a>, <a class="code" href="serial_8c.html#a814f24a889da2738662302f05cef093c">current_data_left</a>) &gt;= 0) {</div>
<div class="line">                    <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#a90b21c450cfc5c88ba50c5049177f0d2">RX_DATA</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// well, RX_IGNORE should not happen, but we have no means of telling anyone here</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="serial_8c.html#a814f24a889da2738662302f05cef093c">current_data_left</a> == 0) {</div>
<div class="line">            <span class="comment">// we are actually already done. do callback and set status to idle</span></div>
<div class="line">            <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[<a class="code" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a>].callback(<a class="code" href="serial_8c.html#a4a73c94ff2e1a886f0139d4a1a487150">current_channelno</a>, </div>
<div class="line">                    (<a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> == <a class="code" href="serial_8c.html#ab88c7a2f9370ff3179a1247935d18912">RX_IGNORE</a>) ? -1 : 0);</div>
<div class="line">            <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[<a class="code" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a>].channelno = -1;</div>
<div class="line">            <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#ae8dbeb081056c2044a8622100b20f4c5">RX_IDLE</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#a90b21c450cfc5c88ba50c5049177f0d2">RX_DATA</a>:</div>
<div class="line">        <a class="code" href="packet_8h.html#a16bdf2f8eaed2ccf4712247bc5866e7f">packet_write_char</a>(<a class="code" href="serial_8c.html#a3a682bd146c8dfd08d349238cb44a0a4">current_rxpacket</a>, rxdata);</div>
<div class="line">        <span class="comment">// fallthrough</span></div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#ab88c7a2f9370ff3179a1247935d18912">RX_IGNORE</a>:</div>
<div class="line">        <a class="code" href="serial_8c.html#a814f24a889da2738662302f05cef093c">current_data_left</a> --;</div>
<div class="line"><span class="comment">//if (packet_get_contentlen(current_rxpacket) &gt; 1) led_on();</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="serial_8c.html#a814f24a889da2738662302f05cef093c">current_data_left</a> &lt;= 0) {</div>
<div class="line">            <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[<a class="code" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a>].callback(<a class="code" href="serial_8c.html#a4a73c94ff2e1a886f0139d4a1a487150">current_channelno</a>, </div>
<div class="line">                    (<a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> == <a class="code" href="serial_8c.html#ab88c7a2f9370ff3179a1247935d18912">RX_IGNORE</a>) ? -1 : 0);</div>
<div class="line">            <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[<a class="code" href="serial_8c.html#a4badad1d3d72e7a8c6104d604725906e">current_channelpos</a>].channelno = -1;</div>
<div class="line">            <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#ae8dbeb081056c2044a8622100b20f4c5">RX_IDLE</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ab3258ff091e5e10fc76b30cd24e55596_cgraph.png" border="0" usemap="#serial_8c_ab3258ff091e5e10fc76b30cd24e55596_cgraph" alt=""/></div>
<map name="serial_8c_ab3258ff091e5e10fc76b30cd24e55596_cgraph" id="serial_8c_ab3258ff091e5e10fc76b30cd24e55596_cgraph">
<area shape="rect" id="node3" href="packet_8h.html#af0ae4da4d34d8dab4f17f5d9a8e57436" title="packet_set_write" alt="" coords="207,5,329,33"/><area shape="rect" id="node5" href="packet_8h.html#a16bdf2f8eaed2ccf4712247bc5866e7f" title="packet_write_char" alt="" coords="203,57,333,85"/><area shape="rect" id="node7" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3" title="send" alt="" coords="243,161,293,189"/><area shape="rect" id="node9" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d" title="uarthw_can_send" alt="" coords="399,95,526,123"/><area shape="rect" id="node23" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c" title="uarthw_send" alt="" coords="414,251,512,279"/><area shape="rect" id="node11" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12" title="read_char_from_packet" alt="" coords="382,147,544,175"/><area shape="rect" id="node27" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207" title="advance_slots" alt="" coords="409,199,516,227"/><area shape="rect" id="node13" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f" title="packet_get_type" alt="" coords="611,17,730,45"/><area shape="rect" id="node15" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="593,69,748,97"/><area shape="rect" id="node17" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d" title="packet_get_chan" alt="" coords="609,121,732,149"/><area shape="rect" id="node19" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142" title="packet_read_char" alt="" coords="607,173,735,201"/><area shape="rect" id="node21" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510" title="packet_has_data" alt="" coords="609,225,732,253"/><area shape="rect" id="node25" href="uarthw_8c.html#a16407b10e85b038a6ea51bfb8c31ad56" title="_uart_enable_sendisr" alt="" coords="596,277,745,305"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ab3258ff091e5e10fc76b30cd24e55596_icgraph.png" border="0" usemap="#serial_8c_ab3258ff091e5e10fc76b30cd24e55596_icgraph" alt=""/></div>
<map name="serial_8c_ab3258ff091e5e10fc76b30cd24e55596_icgraph" id="serial_8c_ab3258ff091e5e10fc76b30cd24e55596_icgraph">
<area shape="rect" id="node3" href="serial_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="203,5,296,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ada6018e05fbcd807dce52864af635d12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int16_t read_char_from_packet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00312">312</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="packet_8h_source.html#l00079">packet_get_chan()</a>, <a class="el" href="packet_8h_source.html#l00087">packet_get_contentlen()</a>, <a class="el" href="packet_8h_source.html#l00083">packet_get_type()</a>, <a class="el" href="packet_8h_source.html#l00205">packet_has_data()</a>, <a class="el" href="packet_8h_source.html#l00165">packet_read_char()</a>, <a class="el" href="serial_8c_source.html#l00110">TX_CHANNEL</a>, <a class="el" href="serial_8c_source.html#l00111">TX_DATA</a>, <a class="el" href="serial_8c_source.html#l00112">TX_IDLE</a>, <a class="el" href="serial_8c_source.html#l00109">TX_LEN</a>, and <a class="el" href="serial_8c_source.html#l00108">TX_TYPE</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00356">send()</a>.</p>
<div class="fragment"><div class="line">                                                    {</div>
<div class="line">        int16_t rv = -1;</div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#a0b5fc526bad9896abab0a44a2a06322e">TX_TYPE</a>:</div>
<div class="line">                <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a9732bbd7f00ac8d4ed8601a6b14a8b68">TX_LEN</a>;</div>
<div class="line">                rv = 0xff &amp; <a class="code" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f">packet_get_type</a>(buf);</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#a9732bbd7f00ac8d4ed8601a6b14a8b68">TX_LEN</a>:</div>
<div class="line">                <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a0fb4a7d6496e251ae4b9b151f27f7296">TX_CHANNEL</a>;</div>
<div class="line">                rv = (0xff &amp; <a class="code" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03">packet_get_contentlen</a>(buf)) + 3;   <span class="comment">// plus 2 to adhere to packet wire format</span></div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#a0fb4a7d6496e251ae4b9b151f27f7296">TX_CHANNEL</a>:</div>
<div class="line">        rv = 0xff &amp; <a class="code" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d">packet_get_chan</a>(buf);</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03">packet_get_contentlen</a>(buf) == 0) {</div>
<div class="line">                        <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a8466586b863fc4b1722eda703698d847">TX_IDLE</a>;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                        <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#ab7aa78c51c5c51bbfd493bf42bef0de3">TX_DATA</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="serial_8c.html#ab7aa78c51c5c51bbfd493bf42bef0de3">TX_DATA</a>:</div>
<div class="line">                rv = 0xff &amp; <a class="code" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142">packet_read_char</a>(buf);</div>
<div class="line">                <span class="keywordflow">if</span> (!<a class="code" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510">packet_has_data</a>(buf)) {</div>
<div class="line">                        <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a8466586b863fc4b1722eda703698d847">TX_IDLE</a>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> rv;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ada6018e05fbcd807dce52864af635d12_cgraph.png" border="0" usemap="#serial_8c_ada6018e05fbcd807dce52864af635d12_cgraph" alt=""/></div>
<map name="serial_8c_ada6018e05fbcd807dce52864af635d12_cgraph" id="serial_8c_ada6018e05fbcd807dce52864af635d12_cgraph">
<area shape="rect" id="node3" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d" title="packet_get_chan" alt="" coords="233,5,356,33"/><area shape="rect" id="node5" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="217,57,372,85"/><area shape="rect" id="node7" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f" title="packet_get_type" alt="" coords="235,109,354,137"/><area shape="rect" id="node9" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510" title="packet_has_data" alt="" coords="233,161,356,189"/><area shape="rect" id="node11" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142" title="packet_read_char" alt="" coords="231,213,359,241"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ada6018e05fbcd807dce52864af635d12_icgraph.png" border="0" usemap="#serial_8c_ada6018e05fbcd807dce52864af635d12_icgraph" alt=""/></div>
<map name="serial_8c_ada6018e05fbcd807dce52864af635d12_icgraph" id="serial_8c_ada6018e05fbcd807dce52864af635d12_icgraph">
<area shape="rect" id="node3" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3" title="send" alt="" coords="216,57,266,85"/><area shape="rect" id="node5" href="serial_8c.html#ab3258ff091e5e10fc76b30cd24e55596" title="push_data_to_packet" alt="" coords="315,5,464,33"/><area shape="rect" id="node7" href="serial_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="530,31,622,59"/><area shape="rect" id="node10" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9" title="serial_submit" alt="" coords="339,109,439,137"/><area shape="rect" id="node12" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b" title="serial_submit_call" alt="" coords="512,109,640,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6aaf52ad0a4ad585de528c2f40af36e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void send </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00356">356</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00346">advance_slots()</a>, <a class="el" href="serial_8c_source.html#l00312">read_char_from_packet()</a>, <a class="el" href="uarthw_8c_source.html#l00075">uarthw_can_send()</a>, and <a class="el" href="uarthw_8c_source.html#l00084">uarthw_send()</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>, <a class="el" href="serial_8c_source.html#l00453">serial_delay()</a>, and <a class="el" href="serial_8c_source.html#l00484">serial_submit()</a>.</p>
<div class="fragment"><div class="line">                       {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> &gt; 0 &amp;&amp; <a class="code" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d">uarthw_can_send</a>()) {</div>
<div class="line">        <span class="comment">// read data</span></div>
<div class="line">        int16_t data = <a class="code" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12">read_char_from_packet</a>(<a class="code" href="serial_8c.html#a15d19af77ffdf5eb8e5a80a706ed475c">slots</a>[0]);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (data &gt;= 0) {</div>
<div class="line">            <span class="comment">// send it</span></div>
<div class="line">            <a class="code" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c">uarthw_send</a>(data);</div>
<div class="line">            <span class="comment">//led_on();</span></div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">// packet empty, so get next slot</span></div>
<div class="line">            <a class="code" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207">advance_slots</a>();</div>
<div class="line">        }</div>
<div class="line">    }   </div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_cgraph.png" border="0" usemap="#serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_cgraph" alt=""/></div>
<map name="serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_cgraph" id="serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_cgraph">
<area shape="rect" id="node3" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207" title="advance_slots" alt="" coords="132,70,239,98"/><area shape="rect" id="node5" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12" title="read_char_from_packet" alt="" coords="104,122,266,150"/><area shape="rect" id="node17" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d" title="uarthw_can_send" alt="" coords="122,174,249,202"/><area shape="rect" id="node19" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c" title="uarthw_send" alt="" coords="136,239,234,267"/><area shape="rect" id="node7" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d" title="packet_get_chan" alt="" coords="332,5,455,33"/><area shape="rect" id="node9" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="316,57,471,85"/><area shape="rect" id="node11" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f" title="packet_get_type" alt="" coords="334,109,453,137"/><area shape="rect" id="node13" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510" title="packet_has_data" alt="" coords="332,161,455,189"/><area shape="rect" id="node15" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142" title="packet_read_char" alt="" coords="329,213,457,241"/><area shape="rect" id="node21" href="uarthw_8c.html#a16407b10e85b038a6ea51bfb8c31ad56" title="_uart_enable_sendisr" alt="" coords="319,265,468,293"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_icgraph.png" border="0" usemap="#serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_icgraph" alt=""/></div>
<map name="serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_icgraph" id="serial_8c_a6aaf52ad0a4ad585de528c2f40af36e3_icgraph">
<area shape="rect" id="node3" href="serial_8c.html#ab3258ff091e5e10fc76b30cd24e55596" title="push_data_to_packet" alt="" coords="104,5,253,33"/><area shape="rect" id="node5" href="serial_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="319,31,412,59"/><area shape="rect" id="node8" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9" title="serial_submit" alt="" coords="129,109,229,137"/><area shape="rect" id="node10" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b" title="serial_submit_call" alt="" coords="302,109,429,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2a467023822de9459179b4c9a13da0d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_delay </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>send/receive data while waiting for some delay </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00453">453</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>, <a class="el" href="serial_8c_source.html#l00356">send()</a>, and <a class="el" href="uarthw_8c_source.html#l00094">uarthw_receive()</a>.</p>

<p>Referenced by <a class="el" href="bus_8c_source.html#l00132">cmd_handler()</a>, <a class="el" href="delay_8h_source.html#l00035">delayms()</a>, <a class="el" href="main_8c_source.html#l00082">main()</a>, <a class="el" href="serial_8c_source.html#l00469">serial_flush()</a>, <a class="el" href="serial_8c_source.html#l00484">serial_submit()</a>, and <a class="el" href="serial_8c_source.html#l00521">serial_submit_call()</a>.</p>
<div class="fragment"><div class="line">                    {</div>
<div class="line">    <span class="comment">// can we receive?</span></div>
<div class="line">    int16_t data = <a class="code" href="uarthw_8c.html#a94e8c918ce79dc5b09064e8776770956">uarthw_receive</a>();</div>
<div class="line">    <span class="keywordflow">while</span> (data &gt;= 0) {</div>
<div class="line">        <a class="code" href="serial_8c.html#ab3258ff091e5e10fc76b30cd24e55596">push_data_to_packet</a>(0xff &amp; data);</div>
<div class="line">        <span class="comment">// try next byte</span></div>
<div class="line">        data = <a class="code" href="uarthw_8c.html#a94e8c918ce79dc5b09064e8776770956">uarthw_receive</a>();</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// try to send</span></div>
<div class="line">    <a class="code" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3">send</a>();</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a2a467023822de9459179b4c9a13da0d1_cgraph.png" border="0" usemap="#serial_8c_a2a467023822de9459179b4c9a13da0d1_cgraph" alt=""/></div>
<map name="serial_8c_a2a467023822de9459179b4c9a13da0d1_cgraph" id="serial_8c_a2a467023822de9459179b4c9a13da0d1_cgraph">
<area shape="rect" id="node3" href="serial_8c.html#ab3258ff091e5e10fc76b30cd24e55596" title="push_data_to_packet" alt="" coords="147,121,296,149"/><area shape="rect" id="node9" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3" title="send" alt="" coords="384,211,434,239"/><area shape="rect" id="node34" href="uarthw_8c.html#a94e8c918ce79dc5b09064e8776770956" title="uarthw_receive" alt="" coords="165,238,277,266"/><area shape="rect" id="node5" href="packet_8h.html#af0ae4da4d34d8dab4f17f5d9a8e57436" title="packet_set_write" alt="" coords="349,159,470,187"/><area shape="rect" id="node7" href="packet_8h.html#a16bdf2f8eaed2ccf4712247bc5866e7f" title="packet_write_char" alt="" coords="345,5,474,33"/><area shape="rect" id="node25" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d" title="uarthw_can_send" alt="" coords="541,57,667,85"/><area shape="rect" id="node27" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c" title="uarthw_send" alt="" coords="555,109,653,137"/><area shape="rect" id="node11" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207" title="advance_slots" alt="" coords="551,211,657,239"/><area shape="rect" id="node13" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12" title="read_char_from_packet" alt="" coords="523,263,685,291"/><area shape="rect" id="node15" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d" title="packet_get_chan" alt="" coords="751,263,873,291"/><area shape="rect" id="node17" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="734,315,890,343"/><area shape="rect" id="node19" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f" title="packet_get_type" alt="" coords="752,367,872,395"/><area shape="rect" id="node21" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510" title="packet_has_data" alt="" coords="751,159,873,187"/><area shape="rect" id="node23" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142" title="packet_read_char" alt="" coords="748,211,876,239"/><area shape="rect" id="node29" href="uarthw_8c.html#a16407b10e85b038a6ea51bfb8c31ad56" title="_uart_enable_sendisr" alt="" coords="737,107,887,135"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a2a467023822de9459179b4c9a13da0d1_icgraph.png" border="0" usemap="#serial_8c_a2a467023822de9459179b4c9a13da0d1_icgraph" alt=""/></div>
<map name="serial_8c_a2a467023822de9459179b4c9a13da0d1_icgraph" id="serial_8c_a2a467023822de9459179b4c9a13da0d1_icgraph">
<area shape="rect" id="node3" href="bus_8c.html#a68ec77741c71e9f01f346016e85f3e7b" title="cmd_handler" alt="" coords="1552,537,1651,565"/><area shape="rect" id="node9" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="2059,1050,2109,1078"/><area shape="rect" id="node11" href="delay_8h.html#a304927311300df9e48c410ac5732d173" title="delayms" alt="" coords="162,406,233,434"/><area shape="rect" id="node117" href="serial_8h.html#a94547a891c369354cec16547930de449" title="serial_flush" alt="" coords="153,970,242,998"/><area shape="rect" id="node122" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9" title="serial_submit" alt="" coords="147,1203,247,1231"/><area shape="rect" id="node124" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b" title="serial_submit_call" alt="" coords="298,1178,425,1206"/><area shape="rect" id="node5" href="bus_8h.html#ac5b8727fd6b9e6bdaf98977f90832dcc" title="bus_attention" alt="" coords="1699,510,1800,538"/><area shape="rect" id="node7" href="ieee_8h.html#a47341f8a6f71378581fb6a67ece35ed2" title="ieee_mainloop_iteration" alt="" coords="1848,715,2011,743"/><area shape="rect" id="node13" href="channel_8h.html#a2f03f94142b87d3c287c17d558ca81bb" title="channel_close" alt="" coords="1011,458,1117,486"/><area shape="rect" id="node35" href="channel_8c.html#ae7784dd177e78324ea066e9a2e475737" title="channel_preload_int" alt="" coords="800,327,941,355"/><area shape="rect" id="node52" href="channel_8h.html#a5bfb7b380fbcb047cb5b839823ed019d" title="channel_put" alt="" coords="314,82,408,110"/><area shape="rect" id="node59" href="channel_8h.html#a5eb3ce54c85a9984a99446a4bd7cc180" title="channel_refill" alt="" coords="481,154,581,182"/><area shape="rect" id="node62" href="packet_8h.html#a2cade8ffc72b19e08f8fbff1ce795417" title="packet_wait_done" alt="" coords="297,970,426,998"/><area shape="rect" id="node15" href="bus_8c.html#aa005573fc6338f79631c8fa5547b7cf5" title="bus_close" alt="" coords="1397,409,1478,437"/><area shape="rect" id="node18" href="bus_8h.html#aaf55247b4144eabb80a9f8a9908742cc" title="bus_receivebyte" alt="" coords="1195,277,1314,305"/><area shape="rect" id="node27" href="file_8h.html#a8336bd2f1ed40fc3520412402061d43b" title="file_submit_call" alt="" coords="1198,562,1311,590"/><area shape="rect" id="node20" href="bus_8c.html#a2c2d584fe64320bc811ffeb1d546b3f2" title="bus_prepare" alt="" coords="1553,381,1649,409"/><area shape="rect" id="node23" href="ieee_8c.html#aab59fb97f896fd24eb381d95aef1f098" title="talkloop" alt="" coords="1404,253,1471,281"/><area shape="rect" id="node29" href="cmd2_8h.html#abaf24aaeaa145dec95026ae71251be71" title="command_execute" alt="" coords="1370,562,1504,590"/><area shape="rect" id="node32" href="file_8h.html#a2dac9b9090b14532b84f96929c3cb2cc" title="file_open" alt="" coords="1400,614,1475,642"/><area shape="rect" id="node37" href="channel_8h.html#ab251327a6bfb5495a6f0c4e86b2b4a6d" title="channel_current_byte" alt="" coords="989,250,1139,278"/><area shape="rect" id="node40" href="channel_8h.html#a36f99405322341c5ec6190ad7df984e8" title="channel_has_more" alt="" coords="997,302,1131,330"/><area shape="rect" id="node43" href="channel_8h.html#ab788bfc67eced677c3e8f3b5f4c25d9c" title="channel_next" alt="" coords="1014,354,1114,382"/><area shape="rect" id="node46" href="channel_8h.html#ac164e244d86c59f184bed5e7380885b9" title="channel_preload" alt="" coords="1377,357,1497,385"/><area shape="rect" id="node49" href="channel_8h.html#ac42b73ef4fb417f5eae59ce4bcc34da1" title="channel_preloadp" alt="" coords="1000,198,1128,226"/><area shape="rect" id="node54" href="bus_8h.html#a501ceedc969857e0fff25531a3877bed" title="bus_sendbyte" alt="" coords="641,43,746,71"/><area shape="rect" id="node56" href="ieee_8c.html#a4701558a7300ca20b3519287feb05bc1" title="listenloop" alt="" coords="832,43,910,71"/><area shape="rect" id="node64" href="term_8h.html#ab38e92632b4de8af92283e500910a510" title="term_putc" alt="" coords="490,945,571,973"/><area shape="rect" id="node106" href="term_8h.html#ac69bbec86506f3fd05f22e5a36a845cb" title="term_puts" alt="" coords="490,997,571,1025"/><area shape="rect" id="node113" href="term_8h.html#a8b7f99725317562495eaa6d578ca9ab7" title="term_rom_puts" alt="" coords="475,1049,586,1077"/><area shape="rect" id="node66" href="debug_8h.html#a5b082d074ba501fcb65a5b280331405d" title="debug_putc" alt="" coords="648,637,739,665"/><area shape="rect" id="node91" href="term_8h.html#a1e37452da0152b26046537534dad44ad" title="term_putcrlf" alt="" coords="825,1127,917,1155"/><area shape="rect" id="node69" href="debug_8h.html#a5dd69e91857c89f722568ab6eb8b95da" title="debug_putnib" alt="" coords="820,663,922,691"/><area shape="rect" id="node73" href="serial_8c.html#a723b54d8d0110a7475aee8bc4f99771f" title="directory_converter" alt="" coords="1187,666,1322,694"/><area shape="rect" id="node86" href="name_8h.html#a0e25b9dc05d9d0c2b58510892dacd5eb" title="parse_filename" alt="" coords="1198,614,1311,642"/><area shape="rect" id="node71" href="debug_8h.html#a5a19c73a805a191cb89658d3a3fc308f" title="debug_puthex" alt="" coords="1011,663,1117,691"/><area shape="rect" id="node76" href="pet_s_d_2ieeehw_8c.html#a96773c4d0d22be83b1b84de6cb6ff52d" title="set_atn_irq" alt="" coords="1211,871,1298,899"/><area shape="rect" id="node78" href="xs1541_2ieeehw_8h.html#a2a60f36b918244a1755bf23d56fee284" title="ieeehw_init" alt="" coords="1557,1023,1645,1051"/><area shape="rect" id="node93" href="debug_8h.html#af964f239c289f93b082b6bb75f884fa2" title="debug_putcrlf" alt="" coords="1013,819,1115,847"/><area shape="rect" id="node102" href="main_8c.html#a454d0cd5591e05b11906fadb9b686794" title="ListVersion" alt="" coords="1021,1179,1107,1207"/><area shape="rect" id="node108" href="term_8h.html#a6ce9d2924543daeec9429263daee002c" title="term_printf" alt="" coords="1707,1075,1792,1103"/><area shape="rect" id="node111" href="term_8h.html#a84b48891b3fe1770a264124b9cb9f1eb" title="term_rom_printf" alt="" coords="636,997,751,1025"/><area shape="rect" id="node119" href="term_8h.html#af0742bbf17e400753f1d6551580934ef" title="term_flush" alt="" coords="320,893,403,921"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a94547a891c369354cec16547930de449"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_flush </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>flush the data out the UART </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00469">469</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00453">serial_delay()</a>.</p>

<p>Referenced by <a class="el" href="term_8c_source.html#l00057">term_flush()</a>.</p>
<div class="fragment"><div class="line">                    {</div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> &gt; 0) {</div>
<div class="line">        <a class="code" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1">serial_delay</a>();</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a94547a891c369354cec16547930de449_cgraph.png" border="0" usemap="#serial_8c_a94547a891c369354cec16547930de449_cgraph" alt=""/></div>
<map name="serial_8c_a94547a891c369354cec16547930de449_cgraph" id="serial_8c_a94547a891c369354cec16547930de449_cgraph">
<area shape="rect" id="node3" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="144,5,237,33"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a94547a891c369354cec16547930de449_icgraph.png" border="0" usemap="#serial_8c_a94547a891c369354cec16547930de449_icgraph" alt=""/></div>
<map name="serial_8c_a94547a891c369354cec16547930de449_icgraph" id="serial_8c_a94547a891c369354cec16547930de449_icgraph">
<area shape="rect" id="node3" href="term_8h.html#af0742bbf17e400753f1d6551580934ef" title="term_flush" alt="" coords="145,138,228,166"/><area shape="rect" id="node5" href="debug_8h.html#af964f239c289f93b082b6bb75f884fa2" title="debug_putcrlf" alt="" coords="278,138,380,166"/><area shape="rect" id="node7" href="cmd2_8h.html#abaf24aaeaa145dec95026ae71251be71" title="command_execute" alt="" coords="613,86,747,114"/><area shape="rect" id="node13" href="ieee_8h.html#a47341f8a6f71378581fb6a67ece35ed2" title="ieee_mainloop_iteration" alt="" coords="1091,189,1253,217"/><area shape="rect" id="node17" href="serial_8c.html#a723b54d8d0110a7475aee8bc4f99771f" title="directory_converter" alt="" coords="430,292,565,320"/><area shape="rect" id="node19" href="file_8h.html#a2dac9b9090b14532b84f96929c3cb2cc" title="file_open" alt="" coords="642,34,718,62"/><area shape="rect" id="node22" href="file_8h.html#a8336bd2f1ed40fc3520412402061d43b" title="file_submit_call" alt="" coords="441,86,554,114"/><area shape="rect" id="node27" href="name_8h.html#a0e25b9dc05d9d0c2b58510892dacd5eb" title="parse_filename" alt="" coords="441,34,554,62"/><area shape="rect" id="node31" href="pet_s_d_2ieeehw_8c.html#a96773c4d0d22be83b1b84de6cb6ff52d" title="set_atn_irq" alt="" coords="636,241,724,269"/><area shape="rect" id="node9" href="bus_8c.html#a68ec77741c71e9f01f346016e85f3e7b" title="cmd_handler" alt="" coords="795,86,893,114"/><area shape="rect" id="node11" href="bus_8h.html#ac5b8727fd6b9e6bdaf98977f90832dcc" title="bus_attention" alt="" coords="941,112,1043,140"/><area shape="rect" id="node15" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="1302,216,1352,244"/><area shape="rect" id="node33" href="xs1541_2ieeehw_8h.html#a2a60f36b918244a1755bf23d56fee284" title="ieeehw_init" alt="" coords="800,241,888,269"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7081e02f83b04f6ef96aeb13ba52262d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structprovider__t.html">provider_t</a>* serial_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>initialize the UART </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00555">555</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00099">NUMBER_OF_SLOTS</a>, <a class="el" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>, <a class="el" href="serial_8c_source.html#l00122">RX_IDLE</a>, <a class="el" href="serial_8c_source.html#l00090">serial_provider</a>, and <a class="el" href="serial_8c_source.html#l00112">TX_IDLE</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00082">main()</a>.</p>
<div class="fragment"><div class="line">                          {</div>
<div class="line">    <a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (int8_t i = <a class="code" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>-1; i &gt;= 0; i--) {</div>
<div class="line">        <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[i].channelno = -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="serial_8c.html#a121d79bdb3f9705ff8e0a6c368094a5b">rxstate</a> = <a class="code" href="serial_8c.html#ae8dbeb081056c2044a8622100b20f4c5">RX_IDLE</a>;</div>
<div class="line">    <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a8466586b863fc4b1722eda703698d847">TX_IDLE</a>;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// we should not register (at least for now, as when we are being</span></div>
<div class="line">    <span class="comment">// selected, the remote end does not know about it currently, as we</span></div>
<div class="line">    <span class="comment">// do not notify it. So open requests will be returned with an error</span></div>
<div class="line">    <span class="comment">//provider_register(&quot;FS&quot;, &amp;serial_provider);</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> &amp;<a class="code" href="serial_8c.html#af07f8902149a4e7ca73a4586578457c5">serial_provider</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a7081e02f83b04f6ef96aeb13ba52262d_icgraph.png" border="0" usemap="#serial_8c_a7081e02f83b04f6ef96aeb13ba52262d_icgraph" alt=""/></div>
<map name="serial_8c_a7081e02f83b04f6ef96aeb13ba52262d_icgraph" id="serial_8c_a7081e02f83b04f6ef96aeb13ba52262d_icgraph">
<area shape="rect" id="node3" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="131,5,181,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac3bb6e8286980b507589e1a799e752f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_submit </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>epdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>submit the contents of a buffer to the UART If buffer slot is available, return immediately. Otherwise wait until slot is available</p>
<p>Note: submitter must check <a class="el" href="packet_8h.html#ae18177b6d0283a274422f843fb924d81">packet_is_done()</a> or friends before reuse or freeing the memory! </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00484">484</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="term_8c_source.html#l00041">buf</a>, <a class="el" href="serial_8c_source.html#l00099">NUMBER_OF_SLOTS</a>, <a class="el" href="serial_8c_source.html#l00356">send()</a>, <a class="el" href="serial_8c_source.html#l00453">serial_delay()</a>, <a class="el" href="serial_8c_source.html#l00104">slots_used</a>, and <a class="el" href="serial_8c_source.html#l00108">TX_TYPE</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00521">serial_submit_call()</a>.</p>
<div class="fragment"><div class="line">                                                {</div>
<div class="line"></div>
<div class="line">    <span class="comment">// wait for slot free</span></div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> &gt;= (<a class="code" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>-1)) {</div>
<div class="line">        <a class="code" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1">serial_delay</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="comment">// protect slot* by disabling the interrupt</span></div>
<div class="line">    <span class="comment">//cli();     - as slots are not handled in irq anymore</span></div>
<div class="line">    <span class="comment">// note: slots_used can only decrease until here, as this is the</span></div>
<div class="line">    <span class="comment">// only place to increase it, so there is no race from the while()</span></div>
<div class="line">    <span class="comment">// above to setting it here.    </span></div>
<div class="line">    <a class="code" href="serial_8c.html#a15d19af77ffdf5eb8e5a80a706ed475c">slots</a>[<a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a>] = <a class="code" href="term_8c.html#af534d0180d4264410342a4c3b60aaf21">buf</a>;</div>
<div class="line">    <a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a>++;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="serial_8c.html#aa059c7f18fb4caf7aa2e187d71baf311">slots_used</a> == 1) {</div>
<div class="line">        <span class="comment">// no packet before, so need to start sending</span></div>
<div class="line">        <a class="code" href="serial_8c.html#a417e32f683a22f22699d87c214ef9bfb">txstate</a> = <a class="code" href="serial_8c.html#a0b5fc526bad9896abab0a44a2a06322e">TX_TYPE</a>;</div>
<div class="line">        <a class="code" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3">send</a>();</div>
<div class="line">        <span class="comment">//led_on();</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// enable interrupts again</span></div>
<div class="line">    <span class="comment">//sei();     - as slots are not handled in irq anymore</span></div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ac3bb6e8286980b507589e1a799e752f9_cgraph.png" border="0" usemap="#serial_8c_ac3bb6e8286980b507589e1a799e752f9_cgraph" alt=""/></div>
<map name="serial_8c_ac3bb6e8286980b507589e1a799e752f9_cgraph" id="serial_8c_ac3bb6e8286980b507589e1a799e752f9_cgraph">
<area shape="rect" id="node3" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3" title="send" alt="" coords="176,149,226,177"/><area shape="rect" id="node25" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="155,201,248,229"/><area shape="rect" id="node5" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207" title="advance_slots" alt="" coords="324,70,431,98"/><area shape="rect" id="node7" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12" title="read_char_from_packet" alt="" coords="296,122,458,150"/><area shape="rect" id="node19" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d" title="uarthw_can_send" alt="" coords="314,174,441,202"/><area shape="rect" id="node21" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c" title="uarthw_send" alt="" coords="328,239,426,267"/><area shape="rect" id="node9" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d" title="packet_get_chan" alt="" coords="524,5,647,33"/><area shape="rect" id="node11" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="508,57,663,85"/><area shape="rect" id="node13" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f" title="packet_get_type" alt="" coords="526,109,645,137"/><area shape="rect" id="node15" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510" title="packet_has_data" alt="" coords="524,161,647,189"/><area shape="rect" id="node17" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142" title="packet_read_char" alt="" coords="521,213,649,241"/><area shape="rect" id="node23" href="uarthw_8c.html#a16407b10e85b038a6ea51bfb8c31ad56" title="_uart_enable_sendisr" alt="" coords="511,265,660,293"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ac3bb6e8286980b507589e1a799e752f9_icgraph.png" border="0" usemap="#serial_8c_ac3bb6e8286980b507589e1a799e752f9_icgraph" alt=""/></div>
<map name="serial_8c_ac3bb6e8286980b507589e1a799e752f9_icgraph" id="serial_8c_ac3bb6e8286980b507589e1a799e752f9_icgraph">
<area shape="rect" id="node3" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b" title="serial_submit_call" alt="" coords="155,5,282,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3386cdb2f4c51be5b17839689bb0040b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_submit_call </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>epdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>channelno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname"><em>txbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname"><em>rxbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(int8_t <a class="el" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>, int8_t errnum)&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00521">521</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="serial_8c_source.html#l00119">callback</a>, <a class="el" href="packet_8h_source.html#l00076">packet_t::chan</a>, <a class="el" href="serial_8c_source.html#l00117">channelno</a>, <a class="el" href="debug_8h_source.html#l00045">debug_printf</a>, <a class="el" href="serial_8c_source.html#l00099">NUMBER_OF_SLOTS</a>, <a class="el" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>, <a class="el" href="uarthw_8c_source.html#l00060">rxbuf</a>, <a class="el" href="serial_8c_source.html#l00453">serial_delay()</a>, and <a class="el" href="serial_8c_source.html#l00484">serial_submit()</a>.</p>
<div class="fragment"><div class="line">                                                           {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a> &lt; 0) {</div>
<div class="line">        <a class="code" href="debug_8h.html#a1995b1e018007e8176ca62be5ca5559d">debug_printf</a>(<span class="stringliteral">&quot;!!!! submit with channelno=%d\n&quot;</span>, <a class="code" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (txbuf-&gt;<a class="code" href="structpacket__t.html#a9dbe5b5796c2ae507fad013f8fd7777d">chan</a> &lt; 0) {</div>
<div class="line">        <a class="code" href="debug_8h.html#a1995b1e018007e8176ca62be5ca5559d">debug_printf</a>(<span class="stringliteral">&quot;!!!! submit with packet-&gt;chan=%d\n&quot;</span>, txbuf-&gt;<a class="code" href="structpacket__t.html#a9dbe5b5796c2ae507fad013f8fd7777d">chan</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">// check rx slot</span></div>
<div class="line">    <span class="comment">// wait / loop until receive buffer is being freed by interrupt routine</span></div>
<div class="line">    int8_t channelpos = -1;</div>
<div class="line">    <span class="keywordflow">while</span> (channelpos &lt; 0) {</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>; i++) {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[i].<a class="code" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a> &lt; 0) {</div>
<div class="line">                channelpos = i;</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1">serial_delay</a>();</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[channelpos].channelno = <a class="code" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>;</div>
<div class="line">    <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[channelpos].rxpacket = <a class="code" href="uarthw_8c.html#a78966124af88c57460ff4984045de16b">rxbuf</a>;</div>
<div class="line">    <a class="code" href="serial_8c.html#a60aa9126f8c6113641042eeccf231bd8">rx_channels</a>[channelpos].callback = <a class="code" href="serial_8c.html#ac7063263faf9c3950f983dea0effb3bf">callback</a>;</div>
<div class="line"></div>
<div class="line">    <span class="comment">// send request</span></div>
<div class="line">    <a class="code" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9">serial_submit</a>(epdata, txbuf);</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a3386cdb2f4c51be5b17839689bb0040b_cgraph.png" border="0" usemap="#serial_8c_a3386cdb2f4c51be5b17839689bb0040b_cgraph" alt=""/></div>
<map name="serial_8c_a3386cdb2f4c51be5b17839689bb0040b_cgraph" id="serial_8c_a3386cdb2f4c51be5b17839689bb0040b_cgraph">
<area shape="rect" id="node3" href="delay_8h.html#a2a467023822de9459179b4c9a13da0d1" title="serial_delay" alt="" coords="331,97,424,125"/><area shape="rect" id="node5" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9" title="serial_submit" alt="" coords="182,149,282,177"/><area shape="rect" id="node7" href="serial_8c.html#a6aaf52ad0a4ad585de528c2f40af36e3" title="send" alt="" coords="352,149,402,177"/><area shape="rect" id="node9" href="serial_8c.html#ab9126462beb6d6cfba1d6b5941557207" title="advance_slots" alt="" coords="500,70,607,98"/><area shape="rect" id="node11" href="serial_8c.html#ada6018e05fbcd807dce52864af635d12" title="read_char_from_packet" alt="" coords="472,122,634,150"/><area shape="rect" id="node23" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d" title="uarthw_can_send" alt="" coords="490,174,617,202"/><area shape="rect" id="node25" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c" title="uarthw_send" alt="" coords="504,239,602,267"/><area shape="rect" id="node13" href="packet_8h.html#a34b76089cf01a140b9d44bb17337ba5d" title="packet_get_chan" alt="" coords="700,5,823,33"/><area shape="rect" id="node15" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="684,57,839,85"/><area shape="rect" id="node17" href="packet_8h.html#abd38157c9a5066d33eb199105dc57c0f" title="packet_get_type" alt="" coords="702,109,821,137"/><area shape="rect" id="node19" href="packet_8h.html#addb176aaaeddd33017a9c51693dc4510" title="packet_has_data" alt="" coords="700,161,823,189"/><area shape="rect" id="node21" href="packet_8h.html#a82b582cda143f4b419e8ab621a1d7142" title="packet_read_char" alt="" coords="697,213,825,241"/><area shape="rect" id="node27" href="uarthw_8c.html#a16407b10e85b038a6ea51bfb8c31ad56" title="_uart_enable_sendisr" alt="" coords="687,265,836,293"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab9ddf2fb0d23eab0aa1ccefa91149255"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serial_sync </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>sync with the server </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00576">576</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="wireformat_8h_source.html#l00046">FS_SYNC</a>, <a class="el" href="uarthw_8c_source.html#l00075">uarthw_can_send()</a>, and <a class="el" href="uarthw_8c_source.html#l00084">uarthw_send()</a>.</p>

<p>Referenced by <a class="el" href="main_8c_source.html#l00082">main()</a>.</p>
<div class="fragment"><div class="line">                   {</div>
<div class="line"></div>
<div class="line">    <span class="comment">// sync with the pc server</span></div>
<div class="line">    <span class="comment">// by sending 128 FS_SYNC bytes</span></div>
<div class="line">    <span class="keywordflow">for</span> (uint8_t cnt = 128; cnt &gt; 0; cnt--) {</div>
<div class="line">        <span class="keywordflow">while</span> (!<a class="code" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d">uarthw_can_send</a>());</div>
<div class="line">        <a class="code" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c">uarthw_send</a>(<a class="code" href="wireformat_8h.html#a0e1740f8851fca2f213c033d385f4667">FS_SYNC</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_cgraph.png" border="0" usemap="#serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_cgraph" alt=""/></div>
<map name="serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_cgraph" id="serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_cgraph">
<area shape="rect" id="node3" href="uarthw_8c.html#a9a446e9813b93bc7782622d598df287d" title="uarthw_can_send" alt="" coords="142,5,269,33"/><area shape="rect" id="node5" href="uarthw_8c.html#acb0e0d143a12e48dbb13b23ac1c8515c" title="uarthw_send" alt="" coords="156,57,254,85"/><area shape="rect" id="node7" href="uarthw_8c.html#a16407b10e85b038a6ea51bfb8c31ad56" title="_uart_enable_sendisr" alt="" coords="317,57,467,85"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_icgraph.png" border="0" usemap="#serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_icgraph" alt=""/></div>
<map name="serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_icgraph" id="serial_8c_ab9ddf2fb0d23eab0aa1ccefa91149255_icgraph">
<area shape="rect" id="node3" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="main" alt="" coords="142,5,192,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a712a34abec8b577c05727ef97eaab99d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int8_t to_provider </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structpacket__t.html">packet_t</a> *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>convert PETSCII names to ASCII names </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00287">287</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>References <a class="el" href="term_8c_source.html#l00041">buf</a>, <a class="el" href="packet_8h_source.html#l00095">packet_get_buffer()</a>, <a class="el" href="packet_8h_source.html#l00087">packet_get_contentlen()</a>, and <a class="el" href="petscii_8h_source.html#l00033">petscii_to_ascii()</a>.</p>
<div class="fragment"><div class="line">                                       {</div>
<div class="line">    uint8_t *<a class="code" href="term_8c.html#af534d0180d4264410342a4c3b60aaf21">buf</a> = <a class="code" href="packet_8h.html#adaf82ce76bb2027c911dc455f024e615">packet_get_buffer</a>(p);</div>
<div class="line">    uint8_t len = <a class="code" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03">packet_get_contentlen</a>(p);</div>
<div class="line"><span class="comment">//debug_printf(&quot;CONVERT: len=%d, b=%s\n&quot;, len, buf);</span></div>
<div class="line">    <span class="keywordflow">while</span> (len &gt; 0) {</div>
<div class="line"><span class="comment">//debug_puts(&quot;CONVERT: &quot;); </span></div>
<div class="line"><span class="comment">//debug_putc(*buf); //debug_puthex(*buf);debug_puts(&quot;-&gt;&quot;);</span></div>
<div class="line">        *buf = <a class="code" href="petscii_8h.html#ad499e6bbffd19544131f9de22ee59bb8">petscii_to_ascii</a>(*buf);</div>
<div class="line"><span class="comment">//debug_putc(*buf);debug_puthex(*buf);debug_putcrlf();</span></div>
<div class="line">        buf++;</div>
<div class="line">        len--;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="serial_8c_a712a34abec8b577c05727ef97eaab99d_cgraph.png" border="0" usemap="#serial_8c_a712a34abec8b577c05727ef97eaab99d_cgraph" alt=""/></div>
<map name="serial_8c_a712a34abec8b577c05727ef97eaab99d_cgraph" id="serial_8c_a712a34abec8b577c05727ef97eaab99d_cgraph">
<area shape="rect" id="node3" href="packet_8h.html#adaf82ce76bb2027c911dc455f024e615" title="packet_get_buffer" alt="" coords="156,5,284,33"/><area shape="rect" id="node5" href="packet_8h.html#a89d861cedccb4c116bca4686f5300b03" title="packet_get_contentlen" alt="" coords="142,57,298,85"/><area shape="rect" id="node7" href="petscii_8h.html#ad499e6bbffd19544131f9de22ee59bb8" title="petscii_to_ascii" alt="" coords="164,109,276,137"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac7063263faf9c3950f983dea0effb3bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* callback)(int8_t <a class="el" href="serial_8c.html#aa44526c5384fd0ebbae40062387b2683">channelno</a>, int8_t errnum)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00119">119</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="cmd_8c_source.html#l00118">command_execute()</a>, <a class="el" href="file_8c_source.html#l00069">file_open()</a>, <a class="el" href="file_8c_source.html#l00126">file_submit_call()</a>, and <a class="el" href="serial_8c_source.html#l00521">serial_submit_call()</a>.</p>

</div>
</div>
<a class="anchor" id="aa44526c5384fd0ebbae40062387b2683"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t channelno</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00117">117</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00521">serial_submit_call()</a>.</p>

</div>
</div>
<a class="anchor" id="a4a73c94ff2e1a886f0139d4a1a487150"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int8_t current_channelno</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00129">129</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4badad1d3d72e7a8c6104d604725906e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int8_t current_channelpos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00130">130</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>.</p>

</div>
</div>
<a class="anchor" id="a814f24a889da2738662302f05cef093c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int8_t current_data_left</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00132">132</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab8f6b6d398bc21dfe9dc608da0ee0995"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int8_t current_is_eoi</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00133">133</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3a682bd146c8dfd08d349238cb44a0a4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpacket__t.html">packet_t</a>* current_rxpacket</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00131">131</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="af16b9b5a49ddd8393fa812b5523a2bad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t out[64]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00164">164</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00166">directory_converter()</a>.</p>

</div>
</div>
<a class="anchor" id="a60aa9126f8c6113641042eeccf231bd8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   rx_channels[<a class="el" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Referenced by <a class="el" href="serial_8c_source.html#l00377">push_data_to_packet()</a>, <a class="el" href="serial_8c_source.html#l00555">serial_init()</a>, and <a class="el" href="serial_8c_source.html#l00521">serial_submit_call()</a>.</p>

</div>
</div>
<a class="anchor" id="ab69421981f084b93cfd591a7d8403348"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpacket__t.html">packet_t</a>* rxpacket</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00118">118</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="a121d79bdb3f9705ff8e0a6c368094a5b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int8_t rxstate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00128">128</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="af07f8902149a4e7ca73a4586578457c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structprovider__t.html">provider_t</a> serial_provider</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    <a class="code" href="serial_8c.html#a989dca2fed922a7ea61c23ed6ecba0e3">prov_assign</a>,</div>
<div class="line">    <a class="code" href="serial_8c.html#a380438ade608ee2aaeb7fd989400b34a">prov_free</a>,</div>
<div class="line">        <a class="code" href="serial_8c.html#ac3bb6e8286980b507589e1a799e752f9">serial_submit</a>,</div>
<div class="line">        <a class="code" href="serial_8c.html#a3386cdb2f4c51be5b17839689bb0040b">serial_submit_call</a>,</div>
<div class="line">    <a class="code" href="serial_8c.html#a723b54d8d0110a7475aee8bc4f99771f">directory_converter</a>,</div>
<div class="line">    <a class="code" href="serial_8c.html#a712a34abec8b577c05727ef97eaab99d">to_provider</a></div>
<div class="line">}</div>
</div><!-- fragment --><p>submit the contents of a buffer to the UART If buffer slot is available, return immediately. Otherwise wait until slot is available</p>
<p>Note: submitter must check buf_is_empty() for true or buf_wait_free() before reuse or freeing the memory! </p>

<p>Definition at line <a class="el" href="serial_8c_source.html#l00090">90</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00555">serial_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a15d19af77ffdf5eb8e5a80a706ed475c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpacket__t.html">packet_t</a>* slots[<a class="el" href="serial_8c.html#acb4b7b3034709a082b08fadd8f2bcfea">NUMBER_OF_SLOTS</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00103">103</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa059c7f18fb4caf7aa2e187d71baf311"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t slots_used = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00104">104</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

<p>Referenced by <a class="el" href="serial_8c_source.html#l00484">serial_submit()</a>.</p>

</div>
</div>
<a class="anchor" id="a417e32f683a22f22699d87c214ef9bfb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int8_t txstate</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="serial_8c_source.html#l00106">106</a> of file <a class="el" href="serial_8c_source.html">serial.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 4 2012 04:34:52 for XD2031 firmware by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
