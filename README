XD-2031 - Serial line filesystem server for CBMs
------------------------------------------------

This software enables to program an AVR AtMega device to play
the role of a disk drive to a Commodore PET computer with IEEE488 
interface.

XD-2031 consists of two main parts, an AtMega firmware, and a PC server.
Both communicate via a serial line. 

Currently this hardware is supported:
	- XS-1541 	Communication via serial line over USB

For more information see the README files in the subdirectories

Notes
-----

- With the XS1541 hardware it seems that at least drives that are attached
  to the IEEE488 bus must be switched on. But it works without another drive
  attached.

Copyright
---------

The code is under GPL V2. Please note that the PC server part is
also available on later versions of the GPL, the AtMega firmware is
ONLY(!) available under GPL V2.

(C) 2012 Andre Fachat <afachat@gmx.de>,
	 Ingo Korb, Thomas Winkler, and others!

Please see the individual files for specific copyright notices.


TODO
----

Fix bugs:
	- Error handling and command channel handling does not work
	  well. Need to more specifically define error codes;
	  also a print# to the command channel after open fails.

	- error channel result does not update as it should

	- RENAME is not yet implemented in the fs provider
	
	- the HTTP/FTP (cURL) provider is missing uploads (SAVE)
	  and commands (CHDIR would be good...)

	- The ASSIGN command is still missing, to allow management of
	  drive assignments e.g. to internet servers or host directories

	- PET BASIC4 still hangs on file not found (run/stop works though)

	- SCRATCH (and maybe other) BASIC commands don't work even though
	  they work on a normal OPEN

	- fs_provider does not honor initial start path (always starts in
	  working dir)

	- fs_provider does not free() curpath and realpath on freeing

	- ...


ROADMAP
--------

Here are some ideas about what can be implemented.

With the ASSIGN command it is (will be) possible to assign drive numbers (like the "0" in "$0") 
to different service providers. Some of those will be in the atmega, some will be on the PC side.
Currently there is only one in the atmega, the one that connects via RS232-over-USB. On the PC
side there currently are three, filesystem, FTP and HTTP. All those providers basically implement
the "wireformat" protocol, so it is a clearly separated responsibility. If you are willing to 
help with one of these ideas, feel free to contact me!

In the future these providers can be implemented:

	- A D64 provider on the PC side, to use D64/D80/D82 etc files
	- An sdcard provider on the atmega side to use files on an SD card
	- An iec provider - so a PET can "call out" to a serial IEC floppy
	- And vice versa, an ieee provider and a serial iec bus interface to
	  allow e.g. the C64 to use an IEEE488 disk
	- A remote FS provider on the PC side: connect to a remote "wireformat" server

On the XS1541 I'm actually willing to sacrifice the parallel user port connector (for C64 fastloaders)
in favour of a device number switch, an SD card interface, and maybe a serial configuration PROM.


REFERENCES
----------

XS-1541: The currently supported hardware by T. Winkler is described here:
	http://xs1541.t-winkler.net/

sd2iec:	Some files in this firmware are derived from the sd2iec project by I. Korb
	http://www.c64-wiki.com/index.php/sd2iec_%28firmware%29

cURL:	The cURL library is used to implement internet communication, esp.
	the HTTP and FTP protocols. You can find it at
	http://curl.haxx.se/


